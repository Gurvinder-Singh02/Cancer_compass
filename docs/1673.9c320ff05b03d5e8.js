"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1673],{8081:(x,v,r)=>{r.d(v,{s:()=>d});var s=r(8256),f=r(6895),n=r(5035);function P(i,g){if(1&i&&(s.TgZ(0,"ion-text")(1,"p"),s._uU(2),s.qZA()()),2&i){const u=s.oxw();s.xp6(2),s.Oqu(u.model.subTitle)}}let d=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(u){return new(u||i)},i.\u0275cmp=s.Xpm({type:i,selectors:[["app-empty-screen"]],inputs:{model:"model"},decls:9,vars:3,consts:[[1,"ion-text-center"],["color","secondary",3,"name"],[4,"ngIf"]],template:function(u,m){1&u&&(s.TgZ(0,"ion-grid")(1,"ion-row")(2,"ion-col",0),s._UZ(3,"ion-icon",1),s.qZA()(),s.TgZ(4,"ion-row")(5,"ion-col",0)(6,"ion-label"),s._uU(7),s.qZA(),s.YNc(8,P,3,1,"ion-text",2),s.qZA()()()),2&u&&(s.xp6(3),s.Q6J("name",null==m.model?null:m.model.icon),s.xp6(4),s.hij(" ",null==m.model?null:m.model.title," "),s.xp6(1),s.Q6J("ngIf",null==m.model?null:m.model.subTitle))},dependencies:[f.O5,n.wI,n.jY,n.gu,n.Q$,n.Nd,n.yW],styles:["ion-grid[_ngcontent-%COMP%]{transform:translateY(10vh)}ion-grid[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:5rem}"]}),i})()},1673:(x,v,r)=>{r.d(v,{U:()=>D});var s=r(655),f=r(5698),n=r(8256),P=r(1927),d=r(6775),i=r(5035),g=r(6895),u=r(8081);function m(o,_){1&o&&n._UZ(0,"ion-icon",8)}function y(o,_){1&o&&n._UZ(0,"ion-icon",9)}const a=function(){return[1,2,3,4]},l=function(){return[1]};let h=(()=>{class o{constructor(){this.onClick=new n.vpe}ngOnInit(){}redirect(){this.onClick.emit(this.item)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-user-list"]],inputs:{item:"item"},outputs:{onClick:"onClick"},decls:13,vars:7,consts:[[3,"click"],["no-lines","","detail","true"],["slot","start"],[3,"src"],[1,"ion-padding-bottom","ion-no-margin","ion-text-justify",2,"font-size","11px"],[1,"ion-text-right",2,"margin-right","20px","color","gold"],["name","star",4,"ngFor","ngForOf"],["name","star-outline",4,"ngFor","ngForOf"],["name","star"],["name","star-outline"]],template:function(t,e){1&t&&(n.TgZ(0,"ion-card",0),n.NdJ("click",function(){return e.redirect()}),n.TgZ(1,"ion-item",1)(2,"ion-avatar",2),n._UZ(3,"img",3),n.qZA(),n.TgZ(4,"ion-label")(5,"h3"),n._uU(6),n.qZA()()(),n.TgZ(7,"ion-item")(8,"p",4),n._uU(9),n.qZA()(),n.TgZ(10,"div",5),n.YNc(11,m,1,0,"ion-icon",6),n.YNc(12,y,1,0,"ion-icon",7),n.qZA()()),2&t&&(n.xp6(3),n.Q6J("src",e.item.photo,n.LSH),n.xp6(3),n.hij(" ",null==e.item?null:e.item.name," "),n.xp6(3),n.hij(" ",null==e.item?null:e.item.des," "),n.xp6(2),n.Q6J("ngForOf",n.DdM(5,a)),n.xp6(1),n.Q6J("ngForOf",n.DdM(6,l)))},dependencies:[g.sg,i.BJ,i.PM,i.gu,i.Ie,i.Q$],styles:["ion-card[_ngcontent-%COMP%]{box-shadow:#959da533 0 8px 24px}"]}),o})();const O=["new_chat"],C=["popover"];function M(o,_){if(1&o&&n._UZ(0,"app-empty-screen",18),2&o){const t=n.oxw();n.Q6J("model",t.model)}}function U(o,_){if(1&o&&(n.ynx(0),n.TgZ(1,"ion-avatar",21),n._UZ(2,"img",22),n.qZA(),n.TgZ(3,"ion-label"),n._uU(4),n.qZA(),n.BQk()),2&o){const t=_.ngIf,e=n.oxw(4);let c,p;n.xp6(2),n.Q6J("src",null==(c=e.getUser(t))?null:c.photo,n.LSH),n.xp6(2),n.hij(" ",null==(p=e.getUser(t))?null:p.name," ")}}function Z(o,_){if(1&o){const t=n.EpF();n.TgZ(0,"ion-item",20),n.NdJ("click",function(){const p=n.CHM(t).$implicit,E=n.oxw(3);return n.KtG(E.getChat(p))}),n.YNc(1,U,5,2,"ng-container",13),n.ALo(2,"async"),n.qZA()}if(2&o){const t=_.$implicit;n.Q6J("detail",!0),n.xp6(1),n.Q6J("ngIf",n.lcZ(2,2,null==t?null:t.user))}}function T(o,_){if(1&o&&(n.TgZ(0,"ion-list")(1,"ion-list-header",4),n._uU(2," Messages "),n.qZA(),n.YNc(3,Z,3,4,"ion-item",19),n.qZA()),2&o){const t=n.oxw().ngIf;n.xp6(3),n.Q6J("ngForOf",t)}}function b(o,_){if(1&o&&(n.ynx(0),n.YNc(1,T,4,1,"ion-list",13),n.BQk()),2&o){const t=_.ngIf;n.xp6(1),n.Q6J("ngIf",(null==t?null:t.length)>0)}}function I(o,_){if(1&o){const t=n.EpF();n.TgZ(0,"app-user-list",28),n.NdJ("onClick",function(c){n.CHM(t);const p=n.oxw(3);return n.KtG(p.startChat(c))}),n.qZA()}2&o&&n.Q6J("item",_.$implicit)}function A(o,_){if(1&o&&(n.TgZ(0,"ion-content",4)(1,"ion-list",26),n.YNc(2,I,1,1,"app-user-list",27),n.qZA()()),2&o){const t=_.ngIf;n.xp6(1),n.Udp("background","transparent"),n.xp6(1),n.Q6J("ngForOf",t)}}function w(o,_){if(1&o){const t=n.EpF();n.TgZ(0,"ion-header")(1,"ion-toolbar",1)(2,"ion-title",4),n._uU(3,"New Chat"),n.qZA(),n.TgZ(4,"ion-buttons",23)(5,"ion-button",9),n.NdJ("click",function(){n.CHM(t);const c=n.oxw();return n.KtG(c.cancel())}),n._UZ(6,"ion-icon",24),n.qZA()()()(),n.YNc(7,A,3,3,"ion-content",25),n.ALo(8,"async")}if(2&o){const t=n.oxw();n.xp6(7),n.Q6J("ngIf",n.lcZ(8,1,t.users))}}let D=(()=>{class o{constructor(t,e,c,p){this.router=t,this.chatService=e,this.alertController=c,this.navCtrl=p,this.segment="chats",this.open_new_chat=!1,this.model={icon:"chatbubbles-outline",title:"No Chat Rooms",color:"danger"}}ngOnInit(){this.getRooms()}getRooms(){this.chatService.getChatRooms(),this.chatRooms=this.chatService.chatRooms,console.log("chatrooms: ",this.chatRooms)}gohome(){this.navCtrl.navigateForward("/tabs")}showConfirm(){this.alertController.create({mode:"ios",header:"Confirm",subHeader:"Are you sure want to LOGOUT",buttons:[{text:"Yes",handler:()=>{this.logout()}},{text:"No",handler:()=>{console.log("No")}}]}).then(t=>{t.present()})}logout(){return(0,s.mG)(this,void 0,void 0,function*(){try{console.log("logout"),yield this.chatService.auth.logout(),this.router.navigateByUrl("/login",{replaceUrl:!0})}catch(t){console.log(t)}})}onSegmentChanged(t){console.log(t),this.segment=t.detail.value}newChat(){this.open_new_chat=!0,this.users||this.getUsers()}getUsers(){this.chatService.getUsers(),this.users=this.chatService.users}onWillDismiss(t){}cancel(){this.modal.dismiss(),this.open_new_chat=!1}startChat(t){return(0,s.mG)(this,void 0,void 0,function*(){try{const e=yield this.chatService.createChatRoom(null==t?void 0:t.uid);console.log("room: ",e),this.cancel(),this.router.navigate(["/","home","chats",null==e?void 0:e.id],{queryParams:{name:null==t?void 0:t.name}})}catch(e){console.log(e)}})}getChat(t){(null==t?void 0:t.user).pipe((0,f.q)(1)).subscribe(e=>{console.log("data: ",e),this.router.navigate(["/","home","chats",null==t?void 0:t.id],{queryParams:{name:null==e?void 0:e.name,des:null==e?void 0:e.des}})})}getUser(t){return t}}return o.\u0275fac=function(t){return new(t||o)(n.Y36(P.F0),n.Y36(d.a),n.Y36(i.Br),n.Y36(i.SH))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-home"]],viewQuery:function(t,e){if(1&t&&(n.Gf(O,5),n.Gf(C,5)),2&t){let c;n.iGM(c=n.CRH())&&(e.modal=c.first),n.iGM(c=n.CRH())&&(e.popover=c.first)}},decls:24,vars:8,consts:[[1,"title-header","ion-no-border"],["color","secondary"],["color","light",2,"font-size","18px"],["name","planet-outline",2,"font-size","23px","position","relative","top","6px"],["color","light"],["slot","fixed","vertical","top","horizontal","end",3,"edge"],["color","light",2,"width","45px","height","45px","font-size","24px"],["color","secondary","name","ellipsis-vertical-outline"],["side","bottom"],[3,"click"],["name","log-out"],["name","home"],[3,"model",4,"ngIf"],[4,"ngIf"],["slot","fixed","horizontal","end","vertical","bottom"],["name","add"],[3,"isOpen","willDismiss"],["new_chat",""],[3,"model"],[3,"detail","click",4,"ngFor","ngForOf"],[3,"detail","click"],["slot","start"],[3,"src"],["slot","end"],["color","light","slot","start","name","close-circle-outline"],["color","light",4,"ngIf"],["lines","none",1,"ion-margin-top"],[3,"item","onClick",4,"ngFor","ngForOf"],[3,"item","onClick"]],template:function(t,e){if(1&t&&(n.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title",2),n._uU(3," Cancer Connect "),n._UZ(4,"ion-icon",3),n.qZA()()(),n.TgZ(5,"ion-content",4)(6,"ion-fab",5)(7,"ion-fab-button",6),n._UZ(8,"ion-icon",7),n.qZA(),n.TgZ(9,"ion-fab-list",8)(10,"ion-fab-button",9),n.NdJ("click",function(){return e.showConfirm()}),n._UZ(11,"ion-icon",10),n.qZA(),n.TgZ(12,"ion-fab-button",9),n.NdJ("click",function(){return e.gohome()}),n._UZ(13,"ion-icon",11),n.qZA()()(),n.YNc(14,M,1,1,"app-empty-screen",12),n.ALo(15,"async"),n.YNc(16,b,2,1,"ng-container",13),n.ALo(17,"async"),n.TgZ(18,"ion-fab",14)(19,"ion-fab-button",9),n.NdJ("click",function(){return e.newChat()}),n._UZ(20,"ion-icon",15),n.qZA()(),n.TgZ(21,"ion-modal",16,17),n.NdJ("willDismiss",function(p){return e.onWillDismiss(p)}),n.YNc(23,w,9,3,"ng-template"),n.qZA()()),2&t){let c;n.xp6(6),n.Q6J("edge",!0),n.xp6(8),n.Q6J("ngIf",0===(null==(c=n.lcZ(15,4,e.chatRooms))?null:c.length)),n.xp6(2),n.Q6J("ngIf",n.lcZ(17,6,e.chatRooms)),n.xp6(5),n.Q6J("isOpen",e.open_new_chat)}},dependencies:[g.sg,g.O5,i.BJ,i.YG,i.Sm,i.W2,i.IJ,i.W4,i.zq,i.Gu,i.gu,i.Ie,i.Q$,i.q_,i.yh,i.wd,i.sr,i.ki,u.s,h,g.Ov],styles:["ion-header[_ngcontent-%COMP%]{--box-shadow:0}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--box-shadow:0;--background: var(--ion-color-secondary)}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;justify-content:left;align-items:center;font-size:1.5rem;font-weight:600}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{padding-right:10px}ion-popover[_ngcontent-%COMP%]{--width: 50%}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%]{font-weight:600;font-size:1rem}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{font-family:popins;border-radius:20px;filter:drop-shadow(0px 4px 4px rgba(0,0,0,.15));margin-top:2vh}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:1.1rem}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:500}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:3px}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:.9rem}"]}),o})()},6775:(x,v,r)=>{r.d(v,{a:()=>u});var s=r(655),f=r(4004),n=r(3900),P=r(9646),d=r(8256),i=r(1228),g=r(5146);let u=(()=>{class m{constructor(a,l){this.auth=a,this.api=l}getId(){console.log(this.currentUserId),this.currentUserId=this.auth.getId()}getUsers(){this.users=this.api.collectionDataQuery("users",this.api.whereQuery("uid","!=",this.currentUserId))}createChatRoom(a){return(0,s.mG)(this,void 0,void 0,function*(){try{let l;if(l=yield(yield this.api.getDocs("chatRooms",this.api.whereQuery("members","in",[[a,this.currentUserId],[this.currentUserId,a]]))).docs.map(C=>{let M=C.data();return M.id=C.id,M}),console.log("exist docs: ",l),(null==l?void 0:l.length)>0)return l[0];const O={members:[this.currentUserId,a],type:"private",createdAt:new Date,updatedAt:new Date};return l=yield this.api.addDocument("chatRooms",O),l}catch(l){throw l}})}getChatRooms(){this.getId(),console.log(this.currentUserId),this.chatRooms=this.api.collectionDataQuery("chatRooms",this.api.whereQuery("members","array-contains",this.currentUserId)).pipe((0,f.U)(a=>(console.log("room data: ",a),a.map(l=>{const h=l.members.filter(C=>C!=this.currentUserId);console.log(h);const O=this.api.docDataQuery(`users/${h[0]}`,!0);l.user=O}),a)),(0,n.w)(a=>(0,P.of)(a)))}getChatRoomMessages(a){this.selectedChatRoomMessages=this.api.collectionDataQuery(`chats/${a}/messages`,this.api.orderByQuery("createdAt","desc")).pipe((0,f.U)(l=>l.reverse()))}sendMessage(a,l){return(0,s.mG)(this,void 0,void 0,function*(){try{const h={message:l,sender:this.currentUserId,createdAt:new Date};console.log(a),a&&(yield this.api.addDocument(`chats/${a}/messages`,h))}catch(h){throw h}})}}return m.\u0275fac=function(a){return new(a||m)(d.LFG(i.e),d.LFG(g.s))},m.\u0275prov=d.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()}}]);